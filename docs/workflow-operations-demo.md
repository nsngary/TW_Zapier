# 工作流基本操作功能演示

## 🎯 功能演示指南

本文檔提供工作流基本操作功能的完整演示指南，包括儲存、載入、匯出、匯入和驗證功能。

## 🚀 快速開始

### 1. 啟動應用程式

```bash
cd frontend
npm run dev
```

應用程式將在 `http://localhost:3002` 啟動（如果 3000 和 3001 端口被佔用）。

### 2. 進入工作流編輯器

1. 開啟瀏覽器並訪問應用程式
2. 點擊「開始建立工作流」或直接進入編輯器頁面
3. 您將看到完整的拖拉式工作流編輯器

## 📋 功能演示步驟

### 演示 1：建立和儲存工作流

#### 步驟 1：建立基本工作流
1. **拖拉觸發節點**：
   - 從左側節點庫拖拉「手動觸發」節點到畫布
   - 節點會自動放置在拖拉位置

2. **添加處理節點**：
   - 拖拉「Line 通知」節點到畫布
   - 拖拉「電子郵件」節點到畫布

3. **連接節點**：
   - 從手動觸發節點的輸出點拖拉到 Line 通知節點的輸入點
   - 從 Line 通知節點拖拉到電子郵件節點

4. **配置節點屬性**：
   - 點擊 Line 通知節點
   - 在右側屬性面板中輸入通知訊息：「工作流執行完成」
   - 點擊電子郵件節點
   - 輸入收件人：`user@example.com`
   - 輸入主旨：「工作流通知」

#### 步驟 2：驗證工作流
1. **執行驗證**：
   - 在右側屬性面板點擊「驗證工作流」按鈕
   - 系統會檢查工作流的完整性和邏輯正確性

2. **查看驗證結果**：
   - 如果有錯誤或警告，會在屬性面板中顯示
   - 錯誤用紅色圖標標示，警告用黃色圖標標示
   - 點擊錯誤項目可以看到詳細說明

#### 步驟 3：儲存工作流
1. **點擊儲存按鈕**：
   - 在頂部工具列點擊「儲存」按鈕
   - 或使用快捷鍵 `Ctrl+S` (Windows) / `Cmd+S` (Mac)

2. **輸入工作流名稱**：
   - 在彈出的對話框中輸入：「我的第一個工作流」
   - 點擊「儲存」按鈕

3. **確認儲存成功**：
   - 系統會顯示「工作流已儲存」的成功訊息
   - 如果有警告，會顯示「工作流已儲存，但包含 X 個警告」

### 演示 2：載入已儲存的工作流

#### 步驟 1：開啟工作流
1. **點擊開啟按鈕**：
   - 在頂部工具列的檔案選單中點擊「開啟工作流」

2. **選擇工作流**：
   - 在彈出的對話框中會列出所有已儲存的工作流
   - 輸入要開啟的工作流編號（例如：1）
   - 點擊「開啟」按鈕

3. **確認載入**：
   - 如果當前有未儲存的變更，系統會提示確認
   - 點擊「繼續開啟」以載入選擇的工作流

#### 步驟 2：驗證載入結果
1. **檢查節點和連線**：
   - 確認所有節點都正確載入
   - 確認節點間的連線關係正確

2. **檢查節點配置**：
   - 點擊各個節點查看屬性是否正確載入
   - 確認之前的配置都已恢復

### 演示 3：匯出工作流

#### 步驟 1：準備匯出
1. **確保工作流完整**：
   - 檢查工作流包含所需的節點和連線
   - 執行驗證確保沒有嚴重錯誤

#### 步驟 2：執行匯出
1. **點擊匯出按鈕**：
   - 在頂部工具列的檔案選單中點擊「匯出工作流」

2. **輸入匯出名稱**：
   - 在彈出的對話框中輸入：「示範工作流_v1.0」
   - 點擊「匯出」按鈕

3. **下載檔案**：
   - 瀏覽器會自動下載 JSON 檔案
   - 檔案名稱格式：`示範工作流_v1_0_2024-01-01T12-00-00.json`

#### 步驟 3：檢查匯出檔案
1. **開啟 JSON 檔案**：
   - 使用文字編輯器開啟下載的檔案
   - 檢查檔案結構包含 `metadata` 和 `workflow` 兩個主要部分

2. **驗證檔案內容**：
   ```json
   {
     "metadata": {
       "name": "示範工作流_v1.0",
       "description": "包含 3 個節點和 2 個連線",
       "version": "1.0.0",
       "exportedAt": "2024-01-01T12:00:00.000Z",
       "platform": "TW_Zapier",
       "nodeCount": 3,
       "edgeCount": 2
     },
     "workflow": {
       "nodes": [...],
       "edges": [...],
       "viewport": {...}
     }
   }
   ```

### 演示 4：匯入工作流

#### 方法 1：檔案選擇器匯入
1. **點擊匯入按鈕**：
   - 在頂部工具列的檔案選單中點擊「匯入工作流」

2. **選擇檔案**：
   - 在檔案選擇器中選擇之前匯出的 JSON 檔案
   - 點擊「開啟」

3. **確認匯入**：
   - 如果當前有未儲存的變更，系統會提示確認
   - 點擊「繼續匯入」以載入檔案

#### 方法 2：拖拉檔案匯入
1. **準備檔案**：
   - 在檔案管理器中找到要匯入的 JSON 檔案

2. **拖拉匯入**：
   - 直接將 JSON 檔案拖拉到工作流編輯器畫布上
   - 系統會自動檢測檔案類型並開始匯入

3. **處理匯入結果**：
   - 系統會驗證檔案格式
   - 如果格式正確，會載入工作流到編輯器
   - 如果格式錯誤，會顯示錯誤訊息

### 演示 5：自動儲存和恢復

#### 測試自動儲存
1. **建立工作流**：
   - 建立一個包含多個節點的工作流
   - 不要手動儲存

2. **等待自動儲存**：
   - 系統每 30 秒會自動儲存一次
   - 在瀏覽器開發者工具的 Console 中可以看到自動儲存的日誌

3. **模擬意外中斷**：
   - 直接關閉瀏覽器分頁或重新整理頁面

#### 測試自動恢復
1. **重新開啟應用程式**：
   - 重新訪問工作流編輯器頁面

2. **查看恢復提示**：
   - 如果有未完成的工作流，系統會顯示恢復對話框
   - 點擊「恢復」以載入自動儲存的工作流
   - 點擊「忽略」以開始新的工作流

### 演示 6：驗證功能詳細測試

#### 測試結構驗證
1. **建立空工作流**：
   - 清空畫布，不添加任何節點
   - 點擊「驗證工作流」
   - 應該顯示「工作流中沒有任何節點」的警告

2. **建立無觸發節點的工作流**：
   - 只添加處理節點（如 Line 通知），不添加觸發節點
   - 點擊「驗證工作流」
   - 應該顯示「工作流必須包含至少一個觸發節點」的錯誤

#### 測試節點配置驗證
1. **測試 Line 通知節點**：
   - 添加 Line 通知節點但不填寫訊息
   - 點擊「驗證工作流」
   - 應該顯示「Line 通知節點缺少通知訊息」的錯誤

2. **測試電子郵件節點**：
   - 添加電子郵件節點但不填寫收件人
   - 點擊「驗證工作流」
   - 應該顯示「電子郵件節點缺少收件人」的錯誤

3. **測試台灣手機號碼格式**：
   - 添加簡訊節點並輸入錯誤的手機號碼格式（如：123456789）
   - 點擊「驗證工作流」
   - 應該顯示手機號碼格式錯誤的警告

#### 測試連線驗證
1. **測試孤立節點**：
   - 建立一個包含觸發節點和處理節點的工作流
   - 添加一個額外的處理節點但不連接到工作流
   - 點擊「驗證工作流」
   - 應該顯示孤立節點的警告

## 🎨 用戶體驗重點

### 視覺化反饋
- **載入狀態**：所有操作都有載入指示器
- **成功提示**：操作成功時顯示綠色成功訊息
- **錯誤提示**：操作失敗時顯示紅色錯誤訊息
- **警告提示**：有問題但不阻止操作時顯示黃色警告

### 智能提示
- **變更確認**：覆蓋現有工作前會提示確認
- **格式驗證**：匯入時會檢查檔案格式
- **自動恢復**：頁面載入時提示恢復未完成的工作

### 容錯機制
- **自動儲存**：防止意外遺失工作
- **格式檢查**：防止匯入錯誤檔案
- **驗證機制**：提前發現工作流問題

## 🔧 故障排除

### 常見問題

1. **儲存失敗**：
   - 檢查瀏覽器的本地存儲是否已滿
   - 嘗試清理瀏覽器快取

2. **匯入失敗**：
   - 確認檔案是有效的 JSON 格式
   - 檢查檔案大小是否超過 10MB 限制

3. **驗證錯誤**：
   - 仔細閱讀錯誤訊息
   - 檢查相關節點的配置
   - 確保工作流有完整的邏輯流程

4. **自動恢復不工作**：
   - 檢查是否在 30 分鐘內
   - 確認瀏覽器支援 localStorage

## 🎉 演示完成

通過以上演示，您已經體驗了工作流基本操作的所有核心功能：

- ✅ 工作流儲存和載入
- ✅ 工作流匯出和匯入  
- ✅ 自動儲存和恢復
- ✅ 完整的驗證機制
- ✅ 拖拉檔案匯入
- ✅ 台灣在地化驗證

這些功能為用戶提供了完整的工作流生命週期管理能力，確保工作流的安全性、可靠性和易用性。
